#!/bin/sh

set -e

# Minimal mounts for userland
mount -t devtmpfs devtmpfs /dev
mount -t proc proc /proc
mount -t sysfs sysfs /sys
mount -t tmpfs tmpfs /run
mount -t tmpfs tmpfs /tmp
mkdir -p /dev/pts /dev/shm /run/lock
mount -t devpts devpts /dev/pts
mount -t tmpfs tmpfs /dev/shm
mkdir -p /var/log

export HOME=/root
export DISPLAY=:0
export PATH="/usr/bin:/bin"
export XDG_RUNTIME_DIR=/run

if [ -x /usr/bin/xsetroot ]; then
	/usr/bin/xsetroot -solid black &
fi

exec /usr/bin/xinit /usr/bin/python3 /app.py -- \
	/usr/bin/Xorg :0 -nolisten tcp -noreset -s 0 -dpms -logfile /var/log/Xorg.0.log
